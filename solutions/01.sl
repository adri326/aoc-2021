 ------------#------>o<---<
R            :p0     x-#--+-p
>-R-#-----+-?#------>o :+ V :
|   :lp2= ? |:~s~>        o»--WH
^#--------< |              |
 :K1        >--------------^

^ Part 1
v Part 2

----v
^   >----------#---------------------v----<
!RRR-#-----v   :p0                   o    +p
     :~    >-R-#------?-+-+#---->o   x-#--+:
     :s~s  |   :~lp4= . | |:++so x-#-o :+ V
     :[~]  ^#-----------< >#---->o :<     o»WH
            :K3            :o++            |
                      .--------------------^
