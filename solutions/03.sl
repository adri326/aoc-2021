                                   v-------------<
                                   p         >#--+#-----WH
                                  γ:         |:oo :*
                                  ε:        v?#-----<
                                            | :d←0< |
                                            >#------+------p
 R.                                         |:d←0s-←      n:        Read [5-n]
v#                                          |:d2*[5+]4    f:        Multiply by factor and add to γ
|:da→0p0                            +#------^:d←0s-←      ε:        Read [5-n]
>-#------v                          |:op0p0  :p1s-d2*[4+] γ:        Compute 1-[5-n], multiply by factor and add to ε
¿ :p1+   |                          |:p1p0   :p1+sp2*s    ø:        Increment n and double factor
| :dp0s→ |     >------#----->#------?-v
| :d←0>  |     | V<-< :p0   |:p1+     | n++
+--------<     ^«o  |       |:d←d2d1- | Read [n], push N-[n]
?   >-----------^   |       |:>d1→    | Write [n] > N-[n] to [n]
#--v|            v--+p      |:d1←0>   | Push n < B
:o ||        !#->o»#^:      ^---------<
v#-<‽R#---<   :p0 |:+
|:p0  :oo +-----c#^
>-#-------?v     :p1
| :d1d1%   | Get the n-th char
| :p"1"=s  | Verify if it is equal to 1
| :p1+     | Increment n
| :d←[+d1→ | Read [n], add `char=="1"` and save back
| :d1ad1>  | Push `n < str.length`
^----------+
                                      >-p
                                      |N:
  .                                   |n:
  ^                                   |σ:   >-----p               >-V-<
    < Part 1                          |     |>.  δ:               . o»+--V
  ! < Part 2         >#-----------¿#--+-vV. +c            >-#---v    | v«o
  v                  |:p1+d2[5d[% |:]4 v«o  |   >#-------¿+ :K1 >----^ .|                   >#---------¿#---+p
  | c-------v        |:p"1"=[4+] v+>-v |    +v  |:[dd3%  >#------v      |                   |:p1-d3d1% |:oo |:
  >R‽v      |      . |:lp4≠  v#--<  v# >-#--^>--^:d2≠     :olp2≠ ?#-----^  >--v.<           |:~d2*[4+] |:K1 |
  |  +--v   |      v ^-------<:o >-V|:K1 :d1-≥~ ^----------------<:o       ¿. #-^   .#------^:sp2*sd   |    |
  ^#-<  |   | >#--->-+           | o»v    .                            .#--^  :p0p0  :op0p1 ^----------<    |
   :o !o»+-Vv>^:p0p0 >.         .c ^-+----^                             :p1+lp2=     :d2a                   o     WH
       ^-< o»+ :p0                    >v    >-----p               >-V-<                                     x-#--p^
             >v                       |.    |>.  δ:               . o»+--V                                  o :* :
              |      >#-----------¿#--+-vV. +c            >-#---v    | v«o                                  |
              |      |:p1+d2[5d[% |:]4 v«o  |   >#-------¿+ :K1 >----^ .|                   >#---------¿#---+
              |      |:p"1"=[4+] v+>-v |    +v  |:[dd3%  >#------v      |                   |:p1-d3d1% |:oo p
              |    . |:lp4≠  v#--<  v# >-#--^>--^:d2≠     :olp2≠ ?#-----^  >--v.<           |:~d2*[4+] |:K1 :
              |    v ^-------<:o >-V|:K1 :d1-<~ ^----------------<:o       ¿. #-^   .#------^:sp2*sd   |
              >#--->-+           | o»v    .                            .#--^  :p0p0  :op0p1 ^----------<
               :p0p0 >.         .c ^-+----^                             :p1+lp2=     :d2a
               :p0
                                       .-p
                                        N:
                                        n:
                                        σ:
